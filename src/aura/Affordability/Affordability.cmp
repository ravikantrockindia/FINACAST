<aura:component controller="AffordabilityController" implements="force:appHostable,flexipage:availableForAllPageTypes,flexipage:availableForRecordHome,force:hasRecordId,forceCommunity:availableForAllPageTypes,force:lightningQuickAction" access="global" >
    <aura:attribute type="String" name="Name" />
    <aura:attribute type="Double" name="totalAmount" />
    <aura:attribute name= "score" type="Double"/>
    <aura:attribute type="Double" name="downPayment" />
    
    <aura:attribute name = "futureSim" type="Boolean"/>
    <aura:attribute type="Double" name="installments" />
    <aura:attribute type="Date" name="startDate" />
    <aura:attribute type="Date" name="endDate" />
    <aura:attribute name = "chartDataObject" type = "Object" />
    <aura:attribute name = "data" type="Object"/>
    <aura:attribute name = "financialHealthMessage" type="Object[]"/>
    <aura:attribute type="boolean" name="isTaxBenefit" default="false" />
    <aura:attribute type="boolean" name="isPaymentPlan" default="false" />
    <aura:attribute type="Integer" name="rainyDayMonths" />
    <aura:attribute name="isOpen" type="boolean" default="false"/>
    <aura:attribute type="String" name="displaySection" default = "false" />
     
    <ltng:require scripts="{!$Resource.ChartJs}" />
    <lightning:card  title="">
        <div class="slds-page-header__name-title bud-months" >
            <h1 data-aura-rendered-by="722:0">
                <span class="slds-page-header__title slds-truncate" title="Income" data-aura-rendered-by="723:0">Purchase Advise</span>
            </h1>
            <p>
                The cornerstone of a strong financial strategy is making smart purchases at the right 
                time. Use Finacast before buying an item and learn if you can really afford it. This 
                powerful tool helps you review the impact of the desired purchase, before it's too late.
            </p>
        </div>
        <lightning:tabset>
            <lightning:tab label="Affordability Analysis" >
                <div class="slds-page-header__row">
                    <div class="show_more">
                        <a href="#" >Show more</a>
                    </div>
                    <div class="slds-col slds-size_7-of-12">
                        <lightning:recordEditForm objectApiName="Affordability__c">
                            <div class="aff-data-box">
                                <lightning:inputField  fieldName="What_do_you_want_to_purchase__c"  value="{!v.Name}"/>
                                <p>Name this Affordability Scenario</p>
                            </div>
                            <div class="aff-data-box">
                                <lightning:inputField  fieldName="Cost__c" value="{!v.totalAmount}" />
                                <p>What is the price of the item in the Affordability Scenario</p>
                            </div>
                            <div class="aff-data-box">
                                <lightning:inputField  fieldName="Rainy_Day_Fund_in_month__c" value="{!v.rainyDayMonths}"/>
                                <p>This represents savings for an emergency</p>
                            </div>
                            <div class="aff-data-box">
                                <label style="float: left; display: block; width: 100%;">Is there a payment plan for this item</label>
                                <input type="radio" onclick = "{!c.handleRadio}" name="yesno" id="yesCheck" value="{!v.isPaymentPlan}"/> Yes <input type="radio" onclick = "{!c.handleRadio1}" value="{!v.getNo}" name="yesno" id="noCheck"/> No                        
                                <p style="clear:both;">Choose yes if taking a loan</p>
                                <aura:if isTrue="{!v.displaySection}">
                                    <div id="ifYes" >
                                        <div class="slds-form-element__row">
                                            <div class="slds-size_1-of-2"> 
                                                <lightning:inputField  fieldName="Payment_due_this_month__c" value="{!v.downPayment}" />
                                            </div>
                                            <div class="slds-size_1-of-2"> 
                                                <lightning:inputField  fieldName="Future_monthly_payment__c" value="{!v.installments}"/>
                                            </div>
                                            <div class="slds-size_1-of-2"> 
                                                <lightning:inputField  fieldName="Start_date__c" value="{!v.startDate}" />
                                            </div>
                                            <div class="slds-size_1-of-2"> 
                                                <lightning:inputField  fieldName="End_date__c" value="{!v.endDate}" />
                                            </div>
                                        </div>
                                        
                                        <label style="float: left; display: block; width: 100%; margin-top: 5px;">Tax benefit with intrest</label>   <input type="radio" onclick = "{!c.handleRadio2}" name="yesno" id="yesCheck2" value="{!v.isTaxBenefit}"/> Yes <input type="radio" onclick = "{!c.handleRadio2}" name="yesno" id="noCheck"/> No
                                        <div id="ifYes1" style="visibility:hidden"> 
                                            
                                            <lightning:inputField  fieldName="What_of_contribution_bring_tax_benifit__c" />
                                        </div>  
                                        <label style="float: left; display: block; width: 100%; margin-top: 5px;">Are tax benefit realized monthly</label>   <input type="radio" onclick = "{!c.handleRadio3}" name="yesno" id="yesCheck6" /> Yes <input type="radio" onclick = "{!c.handleRadio3}"  name="yesno" id="noCheck"/> No
                                        <div id="ifYes5" style="visibility:hidden"> 
                                            
                                            <lightning:inputField  fieldName="Maximum_yearly__c" />
                                        </div>
                                    </div>
                                </aura:if>
                            </div>
                            <div class="check-affordability">
                                <lightning:button  label="Check Affordability" onclick="{!c.showResult}" /> 
                                
                                
                            </div>
                        </lightning:recordEditForm>
                    </div>
                    <div class="slds-col slds-size_5-of-12">
                        <div class="aff-data-box1">
                            <h2>Affordability Result</h2>
                            <p>After completing the form on the left and selecting the Check Affordability button, the affordability result will be displayed below.</p>
                        </div>
                        <div class="unkown_aff">
                            <h2>UNKNOWN</h2>
                            <h4>There is currently not enough information to process this prospective purchase.</h4>
                        </div>
                        <hr/>
                        <br/>
                        
                        <div>
                            <h1><b><label style="Color:red;font-size: 20px;">WHY CAN I NOT afford this now?</label></b></h1>
                            You can not afford the downpayment for required for the purchase. <a href="javascript:void(0)" onclick="{!c.openModel }"> <u>Show Details</u></a>
                            <br/>
                            <br/>
                            <h1><b><label style="Color:red;font-size: 20px;">What happens if i buy NOW?</label></b></h1>
                            <p>If you buy the item, you will fall short of {x} to meet your commitment for expenses, debt payments, goals and emergency day fund. Your overall finincial health will negatively impacted. <a href="javascript:void(0)" onclick="{!c.ss}"><u>Show Details</u></a>
                            </p>
                            <aura:if isTrue="{!v.isOpen}">
                                
                                <!--###### MODAL BOX Start######--> 
                                <section role="dialog" tabindex="-1" aria-labelledby="modal-heading-01" aria-modal="true" aria-describedby="modal-content-id-1" class="slds-modal slds-fade-in-open">
                                    <div class="slds-modal__container Summary_cashflow">
                                        <!-- ###### MODAL BOX HEADER Start ######-->
                                        <div class="slds-modal__header">
                                            <lightning:buttonIcon iconName="utility:close"  onclick="{! c.closeModel }" alternativeText="close" variant="bare-inverse"
                                                                  class="slds-modal__close"/> 
                                            <div class="select_year">
                                                <lightning:select name="select1">
                                                    <option value="">2019</option>
                                                </lightning:select>
                                            </div>
                                            <table class="slds-table  slds-table--cell-buffer" >
                                                <thead>
                                                    <th>Accounts and budget item</th>
                                                    <th>May-2019</th>
                                                    <th>Jun-2019</th>
                                                    <th>Jul-2019</th>
                                                    <th>Aug-2019</th>
                                                    <th>Sep-2019</th>
                                                    <th>Oct-2019</th>
                                                    <th>Nov-2019</th>
                                                    <th>Dec-2019</th>
                                                </thead>
                                            </table>
                                        </div>
                                        <!--###### MODAL BOX BODY Part Start######-->
                                        <div class="slds-modal__content slds-p-around_large" id="modal-content-id-1">
                                            <table class="slds-table slds-table--cell-buffer" >
                                                <thead>
                                                    <th>Accounts and budget item</th>
                                                    <th>May-2019</th>
                                                    <th>Jun-2019</th>
                                                    <th>Jul-2019</th>
                                                    <th>Aug-2019</th>
                                                    <th>Sep-2019</th>
                                                    <th>Oct-2019</th>
                                                    <th>Nov-2019</th>
                                                    <th>Dec-2019</th>
                                                </thead>
                                                <tbody>
                                                    <tr>
                                                        <th>Savings at hand</th>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr>
                                                        <th>Expenses</th>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr>
                                                        <th>Planned Income</th>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr>
                                                        <th>Savings allocated to goals</th>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr>
                                                        <th>Credit Card Debts</th>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr>
                                                        <th>Monthly Loan Payments</th>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr>
                                                        <th>Rainy Day Fund Requirement</th>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr>
                                                        <th>Net savings available for the purchase</th>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr>
                                                        <th>One time payment for the purchase</th>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr>
                                                        <th>Monthly Installment</th>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr>
                                                        <th>Net Total</th>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                            
                                        </div>
                                        
                                    </div>
                                </section>
                                <div class="slds-backdrop slds-backdrop_open"></div>
                                <!--###### MODAL BOX Part END Here ######-->
                                
                            </aura:if>
                            
                            <br/>
                            <h1><b><label style="Color:red;font-size: 20px;">When CAN i afford it?</label></b></h1>
                            You can afford a car in {x} months(NOV,2022). <a href="javascript:void(0)" onclick="{!c.openModel}"> <u>Show Details</u></a>
                        </div>
                        
                        
                        <div>
                            <h1><b><label style="Color:green;font-size: 20px;">When CAN i afford this now?</label></b></h1>
                            If you buy right now then, You will have {X} left after paying for expenses and debts and putting money aside for your goals this month. <a href="javascript:void(0)" onclick="{!c.openModel}"> <u>Show Details</u></a>
                            <aura:if isTrue="{!v.isOpen}">
                                
                                <!--###### MODAL BOX Start######--> 
                                <section role="dialog" tabindex="-1" aria-labelledby="modal-heading-01" aria-modal="true" aria-describedby="modal-content-id-1" class="slds-modal slds-fade-in-open">
                                    <div class="slds-modal__container Summary_cashflow">
                                        <!-- ###### MODAL BOX HEADER Start ######-->
                                        <div class="slds-modal__header">
                                            <lightning:buttonIcon iconName="utility:close"  onclick="{! c.closeModel }" alternativeText="close" variant="bare-inverse"
                                                                  class="slds-modal__close"/> 
                                            <div class="select_year">
                                                <lightning:select name="select1">
                                                    <option value="">2019</option>
                                                </lightning:select>
                                            </div>
                                            <table class="slds-table  slds-table--cell-buffer" >
                                                <thead>
                                                    <th>Accounts and budget item</th>
                                                    <th>May-2019</th>
                                                    <th>Jun-2019</th>
                                                    <th>Jul-2019</th>
                                                    <th>Aug-2019</th>
                                                    <th>Sep-2019</th>
                                                    <th>Oct-2019</th>
                                                    <th>Nov-2019</th>
                                                    <th>Dec-2019</th>
                                                </thead>
                                            </table>
                                        </div>
                                        <!--###### MODAL BOX BODY Part Start######-->
                                        <div class="slds-modal__content slds-p-around_large" id="modal-content-id-1">
                                            <table class="slds-table slds-table--cell-buffer" >
                                                <thead>
                                                    <th>Accounts and budget item</th>
                                                    <th>May-2019</th>
                                                    <th>Jun-2019</th>
                                                    <th>Jul-2019</th>
                                                    <th>Aug-2019</th>
                                                    <th>Sep-2019</th>
                                                    <th>Oct-2019</th>
                                                    <th>Nov-2019</th>
                                                    <th>Dec-2019</th>
                                                </thead>
                                                <tbody>
                                                    <tr>
                                                        <th>Savings at hand</th>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr>
                                                        <th>Expenses</th>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr>
                                                        <th>Planned Income</th>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr>
                                                        <th>Savings allocated to goals</th>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr>
                                                        <th>Credit Card Debts</th>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr>
                                                        <th>Monthly Loan Payments</th>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr>
                                                        <th>Rainy Day Fund Requirement</th>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr>
                                                        <th>Net savings available for the purchase</th>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr>
                                                        <th>One time payment for the purchase</th>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr>
                                                        <th>Monthly Installment</th>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr>
                                                        <th>Net Total</th>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                            
                                        </div>
                                        
                                    </div>
                                </section>
                                <div class="slds-backdrop slds-backdrop_open"></div>
                                <!--###### MODAL BOX Part END Here ######-->
                                
                            </aura:if><br/>
                            <h1><b><label style="Color:green;font-size: 20px;">When happens if i buy NOW?</label></b></h1>
                            If you buy the items , your networth at the end of the year 2029 will be{x vs x} if you decide not to buy items. <a href="javascript:void(0)" onclick="{!c.doSomething}"> <u>Show Details</u></a>
                            
                        </div>
                        
                    </div>
                </div>
            </lightning:tab>
            <lightning:tab label="Compare Options" onactive="{!c.showFinHealth}">
                
            <div class="f-health-help slds-text-link slds-text-align_right slds-text-heading_small" style="">
                    <a href="javascript:void(0)" aria-describedby="help" onclick="{!c.openHelpBox}">Help</a>
                    <!--<span>Help</span>-->
                    <aura:if isTrue="{!v.helpBox}">
                        <div class="help-box-financialhealth" >
                            <section role="dialog" tabindex="-1" aria-labelledby="modal-heading-01" aria-modal="true" aria-describedby="modal-content-id-1" class="slds-modal slds-fade-in-open slds-modal_medium">
                                <div class="slds-modal__container">
                                    <header class="slds-modal__header slds-modal__header_empty">
                                        <button class="slds-button slds-button_icon slds-modal__close slds-button_icon-inverse" title="Close" onclick="{!c.closeHelpBox}">
                                            <lightning:icon iconName="utility:close" size="medium" variant="bare"/>
                                            <span class="slds-assistive-text">Close</span>
                                        </button>
                                        
                                    </header>
                                    <div class="slds-modal__content" id="modal-content-id-1">
                                        <div class="slds-grid slds-gutters">
                                            <div class="slds-col slds-size_1-of-4" style="background-color:#25368B">
                                                <div class="slds-text-heading_large" style = "color:white; font-weight: 700; padding:10px; margin: 45% 0 0; text-align: center;">
                                                    
                                                    <span >Your Financial Health</span>
                                                    
                                                </div>
                                            </div>
                                            <div class="slds-col slds-size_3-of-4" style="padding: 20px">
                                                <div class="simulation-pop-up slds-text-body_regular slds-text-align_left slds-text-color_default" style = "font-weight:400">
                                                    <div style="padding: 0 5px;">
                                                        <span style="font-weight: 600; margin-bottom: 10px; display: block;">Your financial score is an indicator of how likely you are to meet your current financial commitments like:
                                                        </span>
                                                        <ol class="slds-list--dotted">
                                                            <li>Your expenses for the next month</li> 
                                                            <li>Your immediate credit card dues</li> 
                                                            <li>Your immediate loan payments</li> 
                                                            <li>Immediate savings needed for your financial goals</li>
                                                        </ol> 
                                                        
                                                        <div style="padding-top: 10px">
                                                            The score is graded between 0 and 10, depending on your likelihood of meeting the above financial commitments. In addition, this score also takes into account the number of months that you can survive without an income.
                                                            
                                                            <br/>The green, orange and red color indicators for each of the sections tells you if your expenses, loans and credit card payments are likely to be met fully or partially in the next month.
                                                        </div>
                                                        <span style = "font-weight:900;"> 
                                                            <br/>Score Key 
                                                        </span>
                                                    </div>
                                                    <table class="slds-table slds-table--bordered slds-table--cell-buffer financial_table">
                                                        <tr>
                                                            <th>Below 1</th>
                                                            <td>You are unlikely to meet your everyday expenses in the next month</td>
                                                        </tr>
                                                        <tr>
                                                            <th>Between 1 and 4</th>
                                                            <td>You are likely to meet your everyday expenses but not meet your debt commitments</td>
                                                        </tr>
                                                        <tr>
                                                            <th>Between 4 and 5</th>
                                                            <td>Between 4 and 5	You will meet your expenses, and debt commitments but may not have enough to save for other financial goals</td>
                                                        </tr>
                                                        <tr>
                                                            <th>Above 5</th>
                                                            <td>You will meet your immediate expenses, debt commitments and save for other goals. You are also likely to have enough to live for a few days without an income</td>
                                                        </tr>
                                                    </table>
                                                   
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </section>
                            <div class="slds-backdrop slds-backdrop_open"></div>
                        </div>
                        
                    </aura:if>
                </div>
                <lightning:card class="chart">
                    
                    <div class="slds-page-header__row">
                        <div class="slds-size_2-of-12"></div>
                        <div class="slds-size_8-of-12">
                            <span> 
                                <div class="chart1" style="">
                                    <div class="chart1-child">
                                        <canvas aura:id="financialHealthGraph"></canvas>
                                    </div>
                                </div> 
                            </span>
                            
                        </div>
                        
                        <div class="slds-size_2-of-12">
                            <span>
                                <div class="bar">
                                    <lightning:slider label="Score" type="vertical" min="0" max = "10" 
                                                      value="{!v.score}" disabled="true" size="small"/>
                                </div>
                            </span>
                        </div>

                    </div>
                    <div class="slds-text-align_center label-font" style="margin: 0px 0;">
                        <span>Select a year to view that years forecast</span>
                    </div>
                    <div class="slds-text-align_center"  style="margin-bottom: 15px;">
                        <span>
                            <button class="slds-button" onclick = "{!c.showYearlyScorePrev}">
                                <lightning:icon iconName="utility:chevronleft"
                                                alternativeText="prev" size="small"/>
                            </button>
                            
                            <lightning:button class="yearButton"
                                              label="{!v.year}" variant="brand"/>
                            
                            <button class="slds-button" onclick = "{!c.showYearlyScoreNext}">
                                <lightning:icon iconName="utility:chevronright" 
                                                alternativeText="next" size="small"/>    
                            </button>
                        </span>
                    </div>
                    <div class="slds-text-align_center" style="margin: 5px 0 0;">
                        <ui:message title="Messages" severity="confirm" closable="true">
                            <aura:iteration items="{! v.financialHealthMessage}" var="m">
                                
                                {!m.message}<br/>
                            </aura:iteration> 
                        </ui:message>
                    </div>
                    
                </lightning:card>
            </lightning:tab>
        </lightning:tabset>
    </lightning:card>
    
</aura:component>