<aura:component controller="AddIncomeController" implements="force:appHostable,flexipage:availableForAllPageTypes,lightning:isUrlAddressable,flexipage:availableForRecordHome,force:hasRecordId,forceCommunity:availableForAllPageTypes,force:lightningQuickAction,lightning:actionOverride" access="global" >
    <aura:handler name="init" value="{!this}" action="{!c.getmonthlybudget}"/> 
    <aura:handler name="saveIncomeEvent" event="c:SaveIncomeEvent" action="{!c.getmonthlybudget}"/>
 
    <aura:registerEvent name="saveIncomeEvent" type="c:SaveIncomeEvent"/>   
    <aura:attribute name = "data" type = "Object"/>
    <aura:attribute name="cid" type="String"/>  
    <lightning:workspaceAPI aura:id="workspace"/>
     <aura:attribute name = "IncomePart" type="Boolean" default="false" />
    <aura:attribute name = "TransctionPart" type="Boolean"  default="false"/>
    <aura:attribute name="tabName" type="String" default=" Budget"/>
    <aura:attribute name = "parentInitialised" type = "boolean" default = "false" />
    <aura:attribute name="addIncome" type="Boolean"/>
    <aura:attribute name="addExpense" type="Boolean"/>
    <aura:attribute name = "namespace" type = "String"/>
    <aura:attribute name="addGoal" type="FinServ__FinancialGoal__c[]"/>
    <aura:attribute name="addGoals" type="Boolean"/> 
    <aura:attribute name="addLoan" type="Boolean"/> 
    <aura:attribute name="addTransaction" type="Boolean"/> 
    <aura:attribute name="addExpenseTransaction" type="Boolean"/> 
    <aura:attribute name="addLoanTransaction" type="Boolean"/> 
    <aura:attribute name="addTrans" type="FinServ__FinancialAccountTransaction__c[]"/> 
    <aura:attribute name="addExpenseTrans" type="FinServ__FinancialAccountTransaction__c[]"/>
    <aura:attribute name="addLoanTrans" type="FinServ__FinancialAccountTransaction__c[]"/>
    <aura:attribute name="budgetName" type="String"/>
    <aura:attribute name="recordId" type="Id"/>
    <aura:attribute name="today" type="String" />
    <aura:attribute name="GoalDetails" type="FinServ__FinancialGoal__c[]" />
    <aura:attribute name="recordTypeId" type="String"/>
    <aura:attribute name="recordTypeId1" type="String"/>
    <aura:attribute name="TotalIncomes" type="Integer"/>
    <aura:attribute name="IncomeRecord" type="object" />
        <aura:attribute name="selectedIncomeRecord" type="object" />
  <aura:attribute name="selectedLoanRecord" type="object" />
    <aura:attribute name="LoanRecord" type="object" />
    <aura:attribute name ="btvalue" type="String" default="SF"/>
    <aura:attribute name="IncomeRecTypeID" type="String" />
    <aura:attribute name="showModalIncome" type="Boolean" />
    <aura:attribute name="showModalExpense" type="Boolean" />
    <aura:attribute name="showModalLoan" type="Boolean" />
    <aura:attribute name="showModalIncomeTransaction" type="Boolean" />
    <aura:attribute name="showModalExpenseTransaction" type="Boolean" />
    <aura:attribute name="showModalLoanTransaction" type="Boolean" />
    <aura:attribute name ="showModalGoal" type = "Boolean" default="false"/>
    <aura:attribute name="editrecid" type="String"/>
    <aura:attribute name="editrecidExpense" type="String"/>
    <aura:attribute name="editRecNameExpense" type="String"/>
    <aura:attribute name="editrecidLoan" type="String"/>
    <aura:attribute name="editrecidGoal" type="String"/>
    <aura:attribute name="editrecidTransaction" type="String"/>
    <aura:attribute name="editrecidTransactionExpense" type="String"/>
    <aura:attribute name="editrecidTransactionLoan" type="String"/>
    <aura:attribute name="selectedValue" type="String"/>
    <aura:attribute name = "tInc" type = "Double" default="0"/>
    <aura:attribute name = "tExp" type = "Double"/> 
    <aura:attribute name = "tLoan" type = "Double" default="$0"/>
    <aura:attribute name = "tGoal" type = "Double"/>
    <aura:attribute name = "Inc" type = "Decimal"/>   
    <aura:attribute name = "client" type="Account"/>
    <aura:attribute name = "clientName" type="Account"/>
    <aura:attribute name= "Transaction" type="string"/>
    <aura:attribute name= "expenseTransaction" type="string"/>
    <aura:attribute name= "loanTransaction" type="string"/>
    <aura:attribute name="selectedLookUpRecord" type="sObject" default="{}"/>
    <aura:attribute name="isRetirement" type="Boolean" default="false"/>
   <aura:attribute name="isNonRetirement" type="Boolean" default="false" />
    <aura:attribute name = "heading" type = "String"/>
    <aura:attribute name = "subheading" type = "String"/>   
    <aura:attribute name="isPortalUser" type="Boolean" />
    <aura:attribute name = "activeModal" type="Boolean" default = "True"/>
    <aura:attribute name = "getBudgetId" type="String"/>
    <aura:attribute name = "getExpenseBudgetId" type="String"/>
    <aura:attribute name = "getLoanId" type="String"/>
    <aura:attribute name = "accountRecTypeName"  type = "String"/>
    <aura:attribute name = "progress" type = "Integer" default="50"/>
    <aura:attribute name = "SumOfIncomeTrans"  type = "String"/>
    <aura:attribute name = "SumOfExpenseTrans"  type = "String"/>
    <aura:attribute name = "SumOfLoanTrans"  type = "String"/>
    <aura:attribute name="isOpen" type="boolean" default="false"/>
     <aura:attribute name="expensePopup" type="boolean" default="false"/>
    <aura:attribute name="LoanPopup" type="boolean" default="false"/>
     <aura:attribute name = "incomeId" type = "String"/>
    <aura:attribute name="editRecordLoan" type="boolean"/>
    <aura:attribute name="editRecordIncome" type="boolean"/>
    <aura:attribute name="editRecordExpense" type="boolean"/>
    <aura:attribute name="incomeName" type="String"/>
    <aura:attribute name="expenseName" type="String"/>
    <aura:attribute name="loanName" type="String"/>
     <aura:method name = "changeClientData" action = "{!c.changeClientData}">
        <aura:attribute name = "changeData" type = "Object" />
    </aura:method> 
       <aura:attribute name = "goalAcc"  type = "Id"/>   
 
    <aura:attribute name ="amtget"  type = "String"/> 
        <aura:attribute name ="month"  type = "String"/> 

    <aura:attribute name = "selectedClient" type = "String" />
     <aura:handler  event="c:changeclientevent" action="{!c.getmonthlybudget}"/>
    
    <!-- Change Client Card -->
  <!--  <aura:if isTrue="{!not(v.isPortalUser)}">
        <lightning:card  title="">
            <div class="slds-col slds-page-header__row" style="">
            	<div class="slds-text-heading_medium slds-size_3-of-12" style="">Current Client: </div>
                <div class="slds-size_4-of-12 label_none">
                	<lightning:recordEditForm objectApiName="FinServ__FinancialGoal__c">
                     <lightning:inputField fieldName="FinServ__PrimaryOwner__c" value="{! v.selectedClient}" onchange="{! c.changeClient }"  aura:id="inf1"/> 
                    </lightning:recordEditForm>
                    <c:ClientLookup objectAPIName="account" IconName="standard:account" selectedRecord="{!v.selectedLookUpRecord}" label="Client Name" SearchKeyWord = "{!v.clientName.Name}" /> 
                </div>
                 <div class="slds-size_6-of-12" style="padding: 25px 0 0 25px;">
                	<lightning:button variant="brand" label="Change Client" title="Change Client" onclick="{! c.changeClient }"/>
                </div> 
                
                
            </div>
           <br/>
        </lightning:card>
    </aura:if>-->
    <!--Change client card ends-->
    
    <!--Income Bar starts-->
    <!-- <c:tabStructureFinacast ccid="{!v.cid}" namespace="{!v.namespace}"></c:tabStructureFinacast>
    <br/>-->
    <div class="slds-box slds-theme_default" style="height:auto;" >
        <div class="slds-page-header__name-title bud-months">
            <div class="slds-grid ">
                <div class="slds-col slds-size_8-of-12 slds-p-top_x-small">
                    <h1>
                        <span class="slds-page-header__title slds-truncate" title="Income">Budget </span>
                    </h1>
                </div>
                <div class="slds-col slds-size_2-of-12 slds-text-align_right slds-p-top_xx-small">
                    <label class="slds-form-element__label" for="select-01">Select Month</label>
                </div>
                <div class="slds-col slds-size_2-of-12">
                    <div class="slds-form-element">
                        <div class="slds-form-element__control">
                           <lightning:select name="Expense"  aura:id="menuItems"  onchange="{! c.getAllIncomes }" variant="label-hidden"  >
                                                            <aura:iteration items="{!v.today}" var="month"  aura:id="inc">
                                                                <option text="{!month.label}" value="{!month.val}" selected="{!month.val}"/> 
             
                                                            </aura:iteration>
                                                        </lightning:select>
                        </div>
                     </div>
                </div>
            </div>
        </div>
        <!--<div class="slds-page-header__row slds-align_absolute-center bud-months" style="margin-top:5px;">
            <aura:iteration items="{!v.today}" var="month" aura:id="inc" >
                <div class="slds-size_1-of-12">
                    <lightning:button aura:id="menuItems"  onclick="{! c.getAllIncomes }" value="{!month.val}" name="{!month.val}" ></lightning:button>{!month.label}
                </div>
            </aura:iteration>
        </div>-->
        <lightning:spinner variant="brand" size="large" aura:id="Id_spinner" class="slds-hide" />
        <!--Income Bar ends-->
        <!--Roll up bar starts-->
        <div class="slds-align_absolute-center">
            
            <div class="bud-months">    
                <div class="slds-grid slds-gutters"> 
                    <div class="slds-col slds-size_3-of-12 slds-m-top_large slds-m-bottom_medium">
                        <div class="budget-featers total_investment">
                            <div class="slds-media__figure">
                            </div>
                            <div class="slds-media__body">
                                <div class="slds-page-header__name">
                                    <div class="slds-page-header__name-title">
                                        <h3>
                                            <span class="slds-page-header__title slds-truncate" title="Income" value="{!TotalIncomes}" name="{!TotalIncome}">Income </span>
                                        </h3>
                                        <h2>
                                        	<span>{!v.tInc}</span>
                                        </h2>
                                        <img src="{!$Resource.dollar}"/>
                                    </div>
                                </div>
                                <p class="slds-page-header__name-meta">Received : ${!v.SumOfIncomeTrans}</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="slds-col slds-size_3-of-12 slds-m-top_large slds-m-bottom_medium">
                        <div class="budget-featers total_investment">
                        <div class="second_column">
                            <div class="slds-page-header__col-title">
                                <div class="slds-media">
                                </div>
                                <div class="slds-media__body ">
                                    <div class="slds-page-header__name ">
                                        <div class="slds-page-header__name-title">
                                            <h3>
                                                <span class="slds-page-header__title slds-truncate" title="Expense" >Expenses </span>
                                            </h3>
                                            <h2>
                                            	<span>{!v.tExp}</span>
                                            </h2>
                                            <img src="{!$Resource.expenses}"/>
                                        </div>
                                    </div>
                                    <p class="slds-page-header__name-meta" style="color: #f3536e;">Spent : ${!v.SumOfExpenseTrans}</p>
                                </div>
                            </div>
                        </div>
                        </div>
                    </div>
                    
                    <div class="slds-col slds-size_3-of-12 slds-m-top_large slds-m-bottom_medium">
                        <div class="budget-featers total_investment">
                        <div class="third_column">
                            <div class="slds-page-header__col-title">
                                <div class="slds-media">
                                </div>
                                <div class="slds-media__body">
                                    <div class="slds-page-header__name">
                                        <div class="slds-page-header__name-title">
                                            <h3>
                                                <span class="slds-page-header__title slds-truncate" title="Loans">Loans </span>
                                            </h3>
                                            <h2>
                                            	<span>{!v.tLoan}</span>
                                            </h2>
                                            <img src="{!$Resource. loans}"/>
                                        </div>
                                    </div>
                                    <p class="slds-page-header__name-meta">Paid : ${!v.SumOfLoanTrans}</p>
                                </div>
                            </div>
                            </div>
                        </div>
                    </div>
                    <div class="slds-col slds-size_3-of-12 slds-m-top_large slds-m-bottom_medium">
                        <div class="budget-featers total_investment">
                        <div class="third_column">
                            <div class="slds-page-header__col-title">
                                <div class="slds-media">
                                </div>
                                <div class="slds-media__body">
                                    <div class="slds-page-header__name">
                                        <div class="slds-page-header__name-title">
                                            <h3>
                                                <span class="slds-page-header__title slds-truncate" title="goals">Goals </span>
                                            </h3>
                                            <h2>
                                            	<span>{!v.tGoal}</span>
                                            </h2>
                                            <img src="{!$Resource. goals123}"/>
                                        </div>
                                    </div>
                                    <p class="slds-page-header__name-meta">Saved :</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    </div>
                </div>  
            </div>                  
        </div> 
        <!--Rollup bar ends-->
        
        <!--Income record starts-->
        <div class="slds-box"> 
            <div class="slds-section slds-is-open" aura:id="fruitsSection">
                <!--section header-->
                <h3 class="slds-section__title income_dropdown">
                    <button aria-controls="fruitsList" class="slds-button slds-section__title-action">
                        <span onclick="{!c.toggleSection}" data-auraId="fruitsSection">
                            <lightning:icon iconName="utility:switch"
                                            size="x-small"
                                            class=" slds-button__icon_left slds-section__title-action-icon"
                                            alternativeText="button icon" 
                                            />
                        </span>
                        <span class="slds-truncate" >Income</span>
                        <lightning:button class="btn1 slds-m-left_medium" name="Income_Record_Type" label="+ Add New Income" title="Add Income +" onclick="{!c.createIncomeRecord}"/>    
                    </button>
                </h3>
                <!--section body-->
                <div class="slds-section__content" id="fruitsList">
                 <aura:if isTrue="{!not(empty(v.IncomeRecord.incomeRecList))}">
                        <aura:iteration items="{!v.IncomeRecord.incomeRecList}" var="rec" indexVar="index">
            <div class="slds-card__header">
                <div class="slds-section slds-is-open" >
                   
                    <div class="slds-grid slds-gutters">
                        <div class="slds-col slds-size_12-of-12 slds-p-right_none slds-p-left_none">
                            <div class="client_managed active-goal">
                                <div class="slds-grid">
                                   <div class="slds-col slds-size_1-of-12 slds-align_absolute-center">
                                        <img src="{!$Resource.dollar}"/>
                                   </div>
                                   <div class="slds-col slds-size_10-of-12">
                                       <h3 class="slds-m-top_large">
                                            <span style="color: #4e75a3;">{!rec.Name }  </span>
                                            
                                            <span class="slds-float_right slds-float_right1">Budget : <lightning:formattedNumber value="{!rec.amount}" style="currency" currencyCode="USD"/></span>
                                       </h3>
                                        <div class="slds-progress-bar slds-progress-bar_small" aria-valuemin="0" aria-valuemax="100" aria-valuenow="75" role="progressbar">
                                            <span class="slds-progress-bar__value slds-progress-bar__value_success">
                                                <lightning:progressBar value="{!rec.ariavaluenow }" size="large"/>
                                            </span>
                                       </div>
                                       <div class="slds-grid">
                                           <div class="slds-col slds-size_6-of-12 slds-m-bottom_large slds-p-left_none slds-p-right_none">
                                               <a style="padding-top:10px;">  <lightning:button  label="View Transaction" 
                                                                             value="{!index}" onclick="{!c.openModelIncome2}" 
                                                                                      /></a>
                                           </div>
                                           <div class="slds-col slds-size_6-of-12 slds-m-bottom_large slds-p-left_none slds-p-right_none">
                                               <h3><span class="slds-float_right slds-float_right1">${!rec.trIncome } so far this month </span></h3>
                                               <!--<h3><span class="slds-float_right slds-float_right1">$0 so for this month</span></h3>-->
                                           </div>
                                       </div>
                                    </div>
                                    <div class="slds-col slds-size_1-of-12 more-btn slds-align_absolute-center">
                                            &nbsp;<lightning:buttonicon iconName="utility:edit" size="x-small" class="slds-button__icon_left"
                                                                                      alternativeText="Edit" value="{!rec.Id}" onclick="{!c.onClickEdit}" 
                                                                                      />                       
                                            
                                            &nbsp;
                                            <lightning:buttonicon iconName="utility:delete" size="x-small" class="slds-button__icon_left"
                                                                                      alternativeText="Delete"  value="{!rec.Id}" onclick="{!c.incomeClickDelete}"
                                                                                      />                                   
                                            
                                        </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div> </aura:iteration>
                        <aura:set attribute="else">
                            <div class="slds-text-heading_small slds-text-align--center no-data">
                                <p><lightning:icon iconName="utility:classic_interface" alternativeText="Approved" /></p>
                                <div class="slds-p-top_small slds-p-bottom_small"><h3>No Income data found</h3></div>
                            </div>
                        </aura:set>
                    </aura:if>
                </div>
            </div>
        </div>
        <aura:if isTrue="{!v.addIncome}">
            <c:AddIncome namespace="{!v.namespace}" editRecordIncome="{!v.editRecordIncome}" Income = "{!v.recordTypeId}" client="{!v.client}"  title = "Add Income" isActive = "{!v.activeModal}" accRecType = "{!v.accountRecTypeName}" />
        </aura:if>
        <!--Income record ends-->
        <!--Edit modal for income starts-->
        <aura:if isTrue="{!v.showModalIncome}">
            <c:AddIncome Income = "{!v.recordTypeId}" editRecordIncome="{!v.editRecordIncome}" namespace="{!v.namespace}" title = "Edit Income" isActive = "{!v.activeModal}" incmeId = "{!v.editrecid}" client="{!v.client}" />
        </aura:if>
        <!--Edit modal for Income ends-->
        <!--Add Transaction modal-->
        <!--aura:if isTrue="{!v.addTransaction}">
            
            <c:AddTransaction namespace="{!v.namespace}" Transaction = "{!v.Transaction}" client="{!v.client}" cid="{!v.cid}" title = "Add Transaction" isActive = "{!v.activeModal}"  />
            
        </aura:if-->
        <!-- Add Transaction Modal Ends-->
        <!--Edit modal for Transaction starts-->
        <!--aura:if isTrue="{!v.showModalIncomeTransaction}">
            
            <c:AddTransaction  namespace="{!v.namespace}" title = "Edit Transaction" isActive = "{!v.activeModal}" trId = "{!v.editrecidTransaction}"/>
            
        </aura:if-->
        <!--Edit modal for Transaction ends-->
        
        <!-- Expense Record Type starts-->        
        <div class="slds-box"> 
            <!--section 2 start-->  
    <div class="slds-section slds-is-open" aura:id="VegetablesSection">
        <!--section header-->
        <h3 class="slds-section__title income_dropdown">
            <button aria-controls="VegetablesId" class="slds-button slds-section__title-action">
                <span onclick="{!c.toggleSection}" data-auraId="VegetablesSection">
                    <lightning:icon iconName="utility:switch"
                                    alternativeText="button icon"
                                    size="x-small"
                                    class="slds-section__title-action-icon slds-button__icon_left"/>
                </span>
                <span class="slds-truncate" title="Vegetables">Expense</span>
                <lightning:button class="btn1 slds-m-left_medium" name="Expense_Record_Type" label="+ Add New Expenses" title="Add Expense +" onclick="{!c.createExpenseRecord}"/>
            </button>
        </h3>
        <!--section body-->
        <div class="slds-section__content" id="VegetablesId">
             <aura:if isTrue="{!not(empty(v.IncomeRecord.expenseRecList))}">
                
 <aura:iteration items="{!v.IncomeRecord.expenseRecList}" var="rec1" indexVar="index">
     <div class="slds-card__header">
                <div class="slds-section slds-is-open" >
                   
                    <div class="slds-grid slds-gutters slds-p-bottom_medium">
                        <div class="slds-col slds-size_12-of-12 slds-p-right_none slds-p-left_none">
                            <div class="client_managed active-goal">
                                <div class="slds-grid">
                                   <div class="slds-col slds-size_1-of-12 slds-align_absolute-center">
                                        <img src="{!$Resource.expenses}"/>
                                   </div>
                                   <div class="slds-col slds-size_10-of-12">
                                       <h3 class="slds-m-top_large">
                                           <span style="color: #4e75a3;">{!rec1.Name}</span>
                                            
                                            <span class="slds-float_right slds-float_right1"> Budget : <lightning:formattedNumber value="{!rec1.Amount__c}" style="currency" currencyCode="USD"/></span>
                                       </h3>
                                        <div class="slds-progress-bar slds-progress-bar_small" aria-valuemin="0" aria-valuemax="100" aria-valuenow="75" role="progressbar">
                                            <span class="slds-progress-bar__value slds-progress-bar__value_success">
                                               <lightning:progressBar value="{!rec1.ariavaluenow }" size="large" />
                                            </span>
                                       </div>
                                       <div class="slds-grid">
                                           <div class="slds-col slds-size_6-of-12 slds-m-bottom_large slds-p-left_none slds-p-right_none">
                                               <a> <lightning:button  label="View Transaction" 
                                                                      value="{!index}" onclick="{!c.ExpensePopupOpen}" 
                                                                              /></a>
                                           </div>
                                           <div class="slds-col slds-size_6-of-12 slds-m-bottom_large slds-p-left_none slds-p-right_none">
                                               <h3><span class="slds-float_right slds-float_right1">${!rec1.trExpense } so far this month </span></h3>
                                               <!--<h3><span class="slds-float_right slds-float_right1">$0 so for this month</span></h3>-->
                                           </div>
                                       </div>
                                    </div>
                                    <div class="slds-col slds-size_1-of-12 more-btn slds-align_absolute-center">
                                            &nbsp;<lightning:buttonicon iconName="utility:edit" size="x-small" class="slds-button__icon_left"
                                                                              alternativeText="Edit" value="{!rec1.Id}" onclick="{!c.onClickEditExpense}" 
                                                                              />                       
                                            
                                            &nbsp;
                                            <lightning:buttonicon iconName="utility:delete" size="x-small" class="slds-button__icon_left"
                                                                              alternativeText="Delete"  value="{!rec1.Id}" onclick="{!c.expenseClickDelete}"
                                                                              />                                  
                                            
                                        </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div> </aura:iteration>
                                
                         
                
                <aura:set attribute="else">
                    <div class="slds-text-heading_small slds-text-align--center no-data">
                        <p><lightning:icon iconName="utility:classic_interface" alternativeText="Approved" /></p>
                        <div class="slds-p-top_small slds-p-bottom_small"><h3>No Expense Data found</h3></div>
                    </div>
                </aura:set>
            </aura:if>
        </div>
    </div>
    <!--section 2 end-->
                       
           
        </div>
        <aura:if isTrue="{!v.addExpense}">
            <c:AddExpense namespace="{!v.namespace}" editRecordExpense="{!v.editRecordExpense}" Expense = "{!v.recordTypeId}" client="{!v.client}"  title="Add Expense" isActive = "{!v.activeModal}" accExpenseRecType = "{!v.accountRecTypeName}"/>
            
        </aura:if>
        <!--Expense record type ends-->
        
        <!--edit modal for expense starts-->        
        <aura:if isTrue="{!v.showModalExpense}">
            <c:AddExpense namespace="{!v.namespace}" editRecordExpense="{!v.editRecordExpense}" Expense = "{!v.recordTypeId}" expId = "{!v.editrecidExpense}" selectedValue="{!v.editRecNameExpense}" title = "Edit Expense"  isActive = "{!v.activeModal}" client="{!v.client}"/>           
        </aura:if>
        <!--Edit modal for expense ends-->
        <!--Add expense Transaction modal-->
        <!--aura:if isTrue="{!v.addExpenseTransaction}">
            
            <c:AddExpenseTransaction  namespace="{!v.namespace}" expenseTransaction = "{!v.expenseTransaction}" client="{!v.client}" title = "Add Transaction" isActive = "{!v.activeModal}"  />
            
        </aura:if-->
        <!-- Add expense Transaction Modal Ends-->
        <!--aura:if isTrue="{!v.showModalExpenseTransaction}">
            
            <c:AddExpenseTransaction namespace="{!v.namespace}"  title = "Edit Transaction" isActive = "{!v.activeModal}" trExpenseId = "{!v.editrecidTransactionExpense}"/>
            
        </aura:if-->
        
        <!--Loan part starts-->
        <div class="slds-box"> 
             <div class="slds-section slds-is-open" aura:id="colorSection">
        <!--section header-->
        <h3 class="slds-section__title income_dropdown">
            <button aria-controls="VegetablesId" class="slds-button slds-section__title-action">
                <span onclick="{!c.toggleSection}" data-auraId="colorSection">
                    <lightning:icon iconName="utility:switch"
                                    alternativeText="button icon"
                                    size="x-small"
                                    class="slds-section__title-action-icon slds-button__icon_left"/>
                </span>
                <span class="slds-truncate" title="Vegetables">Loan</span>
                 <lightning:button class="btn1 slds-m-left_medium" name="LoanAccount" label="+ Add New Loans" title="Add Loan +" onclick="{!c.createLoanRecord}"/>
            </button>
        </h3>
        <!--section body-->
        <div class="slds-section__content" id="VegetablesId">
           <aura:if isTrue="{!not(empty(v.LoanRecord))}">
                  <aura:iteration items="{!v.LoanRecord}" var="rec2"  indexVar="index">           
     <div class="slds-card__header">
                <div class="slds-section slds-is-open" >
                   
                    <div class="slds-grid slds-gutters slds-p-bottom_medium">
                        <div class="slds-col slds-size_12-of-12 slds-p-right_none slds-p-left_none">
                            <div class="client_managed active-goal">
                                <div class="slds-grid">
                                   <div class="slds-col slds-size_1-of-12 slds-align_absolute-center">
                                        <img src="{!$Resource.loans}"/>
                                   </div>
                                   <div class="slds-col slds-size_10-of-12">
                                       <h3 class="slds-m-top_large">
                                           <span style="color: #4e75a3;">{!rec2.Name}</span>
                                            
                                            <span class="slds-float_right slds-float_right1">Budget : <lightning:formattedNumber value="{!rec2.amount}" style="currency" currencyCode="USD"/></span>
                                       </h3>
                                        <div class="slds-progress-bar slds-progress-bar_small" aria-valuemin="0" aria-valuemax="100" aria-valuenow="75" role="progressbar">
                                            <span class="slds-progress-bar__value slds-progress-bar__value_success">
                                                <lightning:progressBar value="{!rec2.ariavaluenow }" size="large" />
                                            </span>
                                       </div>
                                       <div class="slds-grid">
                                           <div class="slds-col slds-size_6-of-12 slds-m-bottom_large slds-p-left_none slds-p-right_none">
                                                <a> <lightning:button  label="View Transaction" 
                                                                     value="{!index}" onclick="{!c.LoanPopupOpen}" 
                                                                              /> </a>
                                           </div>
                                           <div class="slds-col slds-size_6-of-12 slds-m-bottom_large slds-p-left_none slds-p-right_none">
                                               <h3><span class="slds-float_right slds-float_right1">${!rec2.trLoan } so far this month </span></h3>
                                               <!--<h3><span class="slds-float_right slds-float_right1">$0 so for this month</span></h3>-->
                                           </div>
                                       </div>
                                    </div>
                                    <div class="slds-col slds-size_1-of-12 more-btn slds-align_absolute-center">
                                            &nbsp;<lightning:buttonicon iconName="utility:edit" size="x-small" class="slds-button__icon_left"
                                                                              alternativeText="Edit" value="{!rec2.Id}" onclick="{!c.onClickEditLoan}" 
                                                                              />                       
                                            
                                            &nbsp;
                                            <lightning:buttonicon iconName="utility:delete" size="x-small" class="slds-button__icon_left"
                                                                              alternativeText="Delete"  value="{!rec2.Id}" onclick="{!c.onClickDeleteLoan}"
                                                                              />                                 
                                            
                                        </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div> </aura:iteration>
                              
                <aura:set attribute="else">                    
                    <div class="slds-text-heading_small slds-text-align--center no-data">
                        <p><lightning:icon iconName="utility:classic_interface" alternativeText="Approved" /></p>
                        <div class="slds-p-top_small slds-p-bottom_small"><h3>No Loan Data found</h3></div>
                    </div>
                </aura:set>
            </aura:if>

        </div>
    </div>
          
           
        </div>
        <aura:if isTrue="{!v.addLoan}">
            <c:AddLoan Loan = "{!v.recordTypeId}" editRecordLoan="{!v.editRecordLoan}" namespace="{!v.namespace}"  client="{!v.client}" title="Add Loan" isActive = "{!v.activeModal}" accLoanRecType = "{!v.accountRecTypeName}"/>        
            
        </aura:if>
        
        <!--Loan part ends-->        
        
        <!--Edit Modal for loan starts-->
        <aura:if isTrue="{!v.showModalLoan}">
            <c:AddLoan Loan = "{!v.recordTypeId}" editRecordLoan="{!v.editRecordLoan}" loanId = "{!v.editrecidLoan}" namespace="{!v.namespace}"  title = "Edit Loan" isActive = "{!v.activeModal}" client="{!v.client}"/>           
        </aura:if>
        <!--Edit Modal for loan ends-->       
        <!--Add expense Transaction modal-->
        <!--aura:if isTrue="{!v.addLoanTransaction}">
            
            <c:AddLoanTransaction namespace="{!v.namespace}"  loanTransaction = "{!v.loanTransaction}" client="{!v.client}" title = "Add Transaction" isActive = "{!v.activeModal}"  />
            
        </aura:if-->
        <!-- Add expense Transaction Modal Ends-->
        <!--aura:if isTrue="{!v.showModalLoanTransaction}">
            
            <c:AddLoanTransaction namespace="{!v.namespace}"  title = "Edit Transaction" isActive = "{!v.activeModal}" trLoanId = "{!v.editrecidTransactionLoan}"/>
            
        </aura:if-->
        
        <!--Goal part starts-->      
        <div class="slds-box">
             <div class="slds-section slds-is-open" aura:id="GoalSection">
        <!--section header-->
        <h3 class="slds-section__title income_dropdown">
            <button aria-controls="VegetablesId" class="slds-button slds-section__title-action">
                <span onclick="{!c.toggleSection}" data-auraId="GoalSection">
                    <lightning:icon iconName="utility:switch"
                                    alternativeText="button icon"
                                    size="x-small"
                                    class="slds-section__title-action-icon slds-button__icon_left"/>
                </span>
                <span class="slds-truncate">Goals</span>
                 <lightning:button class="btn1 slds-m-left_medium" name="Goals" label="+ Add New Goals" title="Add Goal +" onclick="{!c.createGoalRecord}"/>
            </button>
        </h3>
        <!--section body-->
        <div class="slds-section__content" id="VegetablesId">
             <!--Add goal button-->
            <aura:if isTrue="{!v.addGoals}">
                    <c:GoalModal client="{!v.cid}" namespace="{!v.namespace}"/>               
            </aura:if>
            <!--Add goal button ends-->
            <aura:if isTrue="{!not(empty(v.addGoal))}">
                <c:GoalPlaning cid="{!v.cid}" namespace="{!v.namespace}" budgetScreen="true" month="{!v.month}"/> 
               <!-- <div style="width:100%;" class="slds-scrollable_y listViewContent total_investment">
                <table class=" income-tab slds-table slds-table_cell-buffer slds-table_bordered slds-table_fixed-layout slds-table-striped slds-table_resizable-cols" style="padding: 0; width: 100%;">
                    <thead>
                        <tr class="slds-line-height_reset">
                            <th class="slds-text-title_caps" scope="col">
                                <div class="slds-truncate" title="Goal Name"> &nbsp;&nbsp;Goal Name</div>
                            </th>
                            <th class="slds-text-title_caps" scope="col">
                                <div class="slds-truncate" title="Target Amount">Monthly Goal Saving</div>
                            </th>  
                            <th class="slds-text-title_caps" scope="col">
                                <div class="slds-truncate" title="Current Amount">Current Goal Amount</div>
                            </th> 
                            <th class="slds-text-title_caps" scope="col">
                                <div class="slds-truncate" title="Action">Action</div>
                            </th>
                        </tr>
                    </thead>               
                    <tbody>
                        <aura:iteration items="{!v.addGoal}" var="Gdetails">
                            <tr class="slds-hint-parent">
                                <th data-label="Goal Name" scope="row">
                                    <div class="slds-truncate" title="Goal Name"><a href="{! '/'+ Gdetails.Id}" tabindex="-1"> &nbsp;&nbsp;{!Gdetails.Name}</a></div>
                                </th>
                                <td data-label="Expected Amount">
                                    <div class="slds-truncate" title="Expected Amount" style="color:black;">$ {! Gdetails.Required_Monthly_Saving__c}</div>
                                </td>
                                <td data-label="Current Amount">
                                    <div class="slds-truncate" title="Current Amount" style="color:black;">$ {! Gdetails.Start_Value__c}</div>
                                </td>
                                <td data-label="Action">
                                    <div class="slds-truncate" title="Action">
                                        &nbsp; <lightning:buttonicon variant="bare" iconName="utility:edit" size="medium" title="Edit" value="{!Gdetails.Id}" onclick="{!c.onClickEditGoals}"/>                       
                                        
                                        &nbsp;
                                        <lightning:buttonicon variant="bare" iconName="utility:delete" size="medium" title="Delete" value="{!Gdetails.Id}" onclick="{!c.onClickDeletegoals}"/>                                   
                                    </div>
                                </td>
                            </tr>  
                        </aura:iteration>
                        
                    </tbody>
                </table>
                </div>-->
                <aura:set attribute="else">
                    <div class="slds-text-heading_small slds-text-align--center no-data">
                        <p><lightning:icon iconName="utility:classic_interface" alternativeText="Approved" /></p>
                        <div class="slds-p-top_small slds-p-bottom_small"><h3>No Goal Data found</h3></div>
                    </div>
                </aura:set>
            </aura:if>
            
        </div>
    </div>
          
            
          
        </div>   
        <!--Edit modal for goal starts-->                    
        <!--<aura:if isTrue="{!v.showModalGoal}">
            <aura:if isTrue="{!v.isRetirement}">       
                <c:GoalformRetirement namespace="{!v.namespace}" retirementGoalId ="{!v.editrecidGoal}" client = "{!v.cid}"  />
            </aura:if>
            <aura:if isTrue="{!v.isNonRetirement}">   -->
               <!-- <c:Goalform namespace="{!v.namespace}"  goalId = "{!v.editrecidGoal}" client = "{!v.cid}" />--> <!-- orginal component NonRetirementgoal -->
          <!--  </aura:if>
            
        </aura:if> -->
        
        <!--Edit modal for goal ends--> 
        <!--Goal part ends-->
        <aura:if isTrue="{!v.isOpen}">
             <c:IncomeTransctionPopup cid="{!v.cid}"  namespace="{!v.namespace}"  client="{!v.client}" isActive = "{!v.activeModal}" addExpenseTrans = "{!v.addExpenseTrans}"  closeModal="{!v.isOpen}" data = "{!v.data}" getExpenseBudgetId ="{!v.getBudgetId}" IncomeRecord="{!v.selectedIncomeRecord}" incomeName="{!v.incomeName}" />
        <!--c:BudgetIncomeCashFlowGraph tansactionId="{!v.incomeId}"  IncomeRecord="{!v.IncomeRecord}" namespace="{!v.namespace}" Transaction = "{!v.Transaction}" client="{!v.client}" cid="{!v.cid}" isActive = "{!v.activeModal}" addTrans="{!v.addTrans}"  closeModal="{!v.isOpen}"/-->
    </aura:if> 
	<aura:if isTrue="{!v.expensePopup}">
        <c:ExpenseTransctionPopup cid="{!v.cid}" client="{!v.client}"  namespace="{!v.namespace}" isActive = "{!v.activeModal}" addExpenseTrans = "{!v.addExpenseTrans}"  closeModal="{!v.expensePopup}" data = "{!v.data}" getExpenseBudgetId ="{!v.getExpenseBudgetId}" IncomeRecord="{!v.selectedIncomeRecord}" expenseName="{!v.expenseName}"/>
        </aura:if> 
        <aura:if isTrue="{!v.LoanPopup}">
        <c:LoanTransctionPopup cid="{!v.cid}"  namespace="{!v.namespace}" client="{!v.client}" isActive = "{!v.activeModal}" addExpenseTrans = "{!v.addExpenseTrans}"  closeModal="{!v.LoanPopup}" data = "{!v.data}" getExpenseBudgetId ="{!v.getLoanId}" IncomeRecord="{!v.selectedLoanRecord}" loanName="{!v.loanName}"/>
        </aura:if>
    </div>   
    
</aura:component>